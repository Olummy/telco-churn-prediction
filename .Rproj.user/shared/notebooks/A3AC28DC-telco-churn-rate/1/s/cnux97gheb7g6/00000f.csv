"0","#| label: ggplot_imp_function"
"0","#| warning: false"
"0","#| message: false"
"0","#| eval: true"
"0",""
"0","ggplot_imp <- function(...) {"
"0","  obj <- list(...)"
"0","  metric_name <- attr(obj[[1]], ""loss_name"")"
"0","  metric_lab <- paste(metric_name, "
"0","                      ""after permutations\n(higher indicates more important)"")"
"0","  "
"0","  full_vip <- bind_rows(obj) %>%"
"0","    filter(variable != ""_baseline_"")"
"0","  "
"0","  perm_vals <- full_vip %>% "
"0","    filter(variable == ""_full_model_"") %>% "
"0","    group_by(label) %>% "
"0","    summarise(dropout_loss = mean(dropout_loss))"
"0","  "
"0","  p <- full_vip %>%"
"0","    filter(variable != ""_full_model_"") %>% "
"0","    mutate(variable = fct_reorder(variable, dropout_loss)) %>%"
"0","    ggplot(aes(dropout_loss, variable)) "
"0","  if(length(obj) > 1) {"
"0","    p <- p + "
"0","      facet_wrap(vars(label)) +"
"0","      geom_vline(data = perm_vals, aes(xintercept = dropout_loss, color = label),"
"0","                 size = 1.4, lty = 2, alpha = 0.7) +"
"0","      geom_boxplot(aes(color = label, fill = label), alpha = 0.2)"
"0","  } else {"
"0","    p <- p + "
"0","      geom_vline(data = perm_vals, aes(xintercept = dropout_loss),"
"0","                 linewidth = 1.4, lty = 2, alpha = 0.7) +"
"0","      geom_boxplot(fill = ""#91CBD765"", alpha = 0.4)"
"0","    "
"0","  }"
"0","  p +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(x = metric_lab, "
"0","         y = NULL,  fill = NULL,  color = NULL)"
"0","}"
